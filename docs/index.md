# はじめに

本ドキュメントは、連合学習と連合学習に関する技術やライブラリについてまとめたもので、
連合学習の環境構築者向けのドキュメントとなる。

連合学習の環境構築者は、主にネットワーク・グラフに関する知識が重要となる。


## 連合学習とは

データを取集せずに学習モデルを合成し、学習モデルを改善していく手法。
データを収集し学習する従来の手法だとプライバシーの問題があるため、近年、異なるドメイン間でデータを送信せず学習させる手法として注目を集める。

## メリット・デメリット

- M: プライバシーの問題を回避できる
- D: 従来のデータセンターでの学習は、学習データの偏りをコントロールできますが、連合学習の場合、データが散らばっているため偏りをコントロールすることができない

より詳しくは次のリンクを参照

- [進歩と未解決の問題](https://arxiv.org/pdf/1912.04977.pdf)


## 連合学習フロー

モデルは次のフローで改善されていく

1. train: Edge側で学習済みモデルを生成する
2. feedback: 複数のEdgeからサーバへモデルを送信する
3. aggregate: モデルを合成する
4. transfer:  合成されたモデルをEdgeへ展開する

## 機械学習の一般的なフロー

1. データ収集
2. データ加工・クレンジング
3. データロード
4. モデル学習
5. モデル評価
6. モデルデプロイ（本番稼働）
7. モデル監視（運用）

## 並列・分散・連合処理について

並列・分散・連合処理について、次のように区別することとする。

1. 並列: １つのマシン上で複数のCPUで同一データセットで同一処理を行い結果を集約する
2. 分散: 複数のマシン上で同一データセットで同一処理を行い（並列を組み合わせてもよい）結果を集約する
3. 連合: 複数のマシン上あるいは複数のCPUを用いて、データセットを共有せず同一処理を行い結果を集約する

連合学習のユースケースとしては、

1. 企業Ａ内のデータセットAを企業Ａ内のEdge A, Edge Bを用いて並列処理でモデルAを生成
2. 企業Ｂ内のデータセットBを企業B内のEdge C, Edge Dを用いて並列処理でモデルBを生成
3. 連合学習サーバにモデルA, モデルBを集約しモデルCを生成
4. 異なる連合学習サーバで生成したモデル群を集約し、モデルDを生成（クロスサイロ）

ということができる理解。

ただし、4.のケース（複数の連合学習サーバ）を組み合わせることは未対応の模様。

https://github.com/FedML-AI/FedML/issues/59


疑問

モデルは隣接ノードの資源を使って集約されていく？
連合学習サーバで集約される？
連合転移学習とは


## 転移学習（Transfer learning）

別のタスクで学習された知識を転移する機械学習の手法


## スケーリングについて


### cross-device

データの所有者自体の数が多いが、データや計算資源は少ない。
IOT機器など。


### cross-silo（クロスサイロ）

データの所有者自体の数は多くないが、データや計算資源は比較的十分にある。
企業間での連合学習などのケース。

## データパーティションについて

### 集中型（FedAVG）

データの流れは非対称で、マネージャーがローカルモデルの情報を集計し、グローバルなパラメータをアップデートする。
セキュリティリスクが高いらしい。

### 分散型（SimFL）

通信が直接データの所有者同士で行われ、すべてのデータの所有者がグローバルなパラメータを更新するあ。


データの流れは非対称とは？？？


## トポロジ

分散型機械学習では、コンピュータネットワークの接続形態（トポロジ）を考慮する必要がある（どのような時、何を選ぶかについては理解していない）。

FedMLには、垂直FL、分割学習、分散型FL、階層型FLなどのさまざまなトポロジ定義がある。

- バス
- スター
- リング
- フルメッシュ
- パーシャルメッシュ
- Centralized
- Hierarchical
- Decentralized
- Vertical
- Split

- symmetry（左右対称）
- asymmetry（左右非対称・非対称トポロジ）

